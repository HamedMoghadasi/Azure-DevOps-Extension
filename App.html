<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>LeadTime and CycleTime</title>
    <link rel="stylesheet" href="styles/app.css" />
  </head>

  <body style="overflow:auto;">
    <script src="lib/VSS.SDK.min.js"></script>
    <script src="dist/jquery.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/series-label.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="modules/highchartsModules.js"></script>
    <script src="scripts/App.js"></script>

    <script>
      VSS.init({
        explicitNotifyLoaded: true,
        usePlatformScripts: true
      });
      VSS.require(["TFS/WorkItemTracking/Services"], function(
        _WorkItemServices
      ) {
        function getWorkItemFormService() {
          return _WorkItemServices.WorkItemFormService.getService();
        }

        VSS.register(VSS.getContribution().id, function() {
          return {
            onLoaded: function(args) {
              getWorkItemFormService().then(function(service) {
                service
                  .getFieldValues([
                    "System.Id",
                    "System.CreatedDate",
                    "Microsoft.VSTS.Common.ClosedDate"
                  ])
                  .then(function(data) {
                    diagramModule.draw(data);
                  });
              });
            }
          };
        });

        VSS.notifyLoadSucceeded();
      });
    </script>

    <div id="diagram">
      <div id="diagramContainer"></div>
    </div>
  </body>
</html>
